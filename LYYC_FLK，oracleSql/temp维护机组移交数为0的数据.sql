
----最后，删除，移交时为0的细表
delete FROM WM_MACHINE_HANDOVER_DETAILU WHERE TRANSFER_QUANTITYU=0;


----移交单号：T202005060029所对应货位：108002中的产品：120mm*21μm BOPP高收缩膜在要料呼叫记录或者移交单接收中不存在，请检查！ 生产计划单号：P202005060002  解决方法如下
DELETE FROM WM_MACHINE_HANDOVER_DETAILU WHERE TRANSFER_BILL_NOU='T202005060036' AND SOURCE_LOCATION_CODEU='102004' AND PRODUCT_NAMEU='红旗渠（芒果）68mm烫印接装纸';
DELETE FROM WM_MACHINE_HANDOVER_DETAILU WHERE TRANSFER_BILL_NOU='T202005060027' AND SOURCE_LOCATION_CODEU='104002' AND PRODUCT_NAMEU='120mm*21μm BOPP高收缩膜';
DELETE FROM WM_MACHINE_HANDOVER_DETAILU WHERE TRANSFER_BILL_NOU='T202005060027' AND SOURCE_LOCATION_CODEU='104002' AND PRODUCT_NAMEU='96mm*230g/m2金色印刷框架纸';
DELETE FROM WM_MACHINE_HANDOVER_DETAILU WHERE TRANSFER_BILL_NOU='T202005060027' AND SOURCE_LOCATION_CODEU='104002' AND PRODUCT_NAMEU='114mm*55g银色复合内衬纸';
DELETE FROM WM_MACHINE_HANDOVER_DETAILU WHERE TRANSFER_BILL_NOU='T202005070027' AND SOURCE_LOCATION_CODEU='102004' AND PRODUCT_NAMEU='红旗渠（芒果）68mm烫印接装纸';
----产品：03090100000000015 【114mm*55g银色复合内衬纸】，还需要40公斤，</br>  解决方法如下
UPDATE WM_MACHINE_CALL_DETAILU SET QUANTITYU=(QUANTITYU - (40000)) WHERE MACHINE_CALL_IDU IN (SELECT IDU FROM WM_MACHINE_CALLU WHERE PRODUCTION_PLAN_NOU='P202005070023' AND MACHINE_CODEU IN (SELECT MACHINE_CODEU FROM WM_MACHINE_PALLETU WHERE WORK_POSITION_NOU='103002')) AND PRODUCT_CODEU='03090100000000015';
----返库货位：204002，产品：硬盒简化循环烟箱（芒果）在要料呼叫记录或者移交单接收中不存在，请检查！” P202005090019  解决方法如下
----在机组呼叫记录中新增 机组余料返库中的数量   ->删除机组余料返库中的物料，还是更新？
DELETE FROM WM_MACHINE_CALL_DETAILU WHERE MACHINE_CALL_IDU IN (SELECT IDU FROM WM_MACHINE_CALLU WHERE PRODUCTION_PLAN_NOU='P202005090019' AND MACHINE_CODEU IN (
  SELECT MACHINE_CODEU FROM WM_MACHINE_PALLETU WHERE WORK_POSITION_NOU='204002'
  )) AND PRODUCT_NAMEU='硬盒简化循环烟箱（芒果）' AND ROWNUM=1;
DELETE FROM WM_MACHINE_CALL_DETAILU WHERE MACHINE_CALL_IDU IN (SELECT IDU FROM WM_MACHINE_CALLU WHERE PRODUCTION_PLAN_NOU='P202005090019' AND MACHINE_CODEU IN (
  SELECT MACHINE_CODEU FROM WM_MACHINE_PALLETU WHERE WORK_POSITION_NOU='204002'
  )) AND PRODUCT_NAMEU='硬盒简化循环烟箱（芒果）' AND ROWNUM=1;
  
UPDATE WM_MACHINE_CALL_DETAILU SET QUANTITYU=(QUANTITYU - (10000.00)) WHERE MACHINE_CALL_IDU IN (SELECT IDU FROM WM_MACHINE_CALLU WHERE PRODUCTION_PLAN_NOU='P202005100043' AND MACHINE_CODEU IN (SELECT MACHINE_CODEU FROM WM_MACHINE_PALLETU WHERE WORK_POSITION_NOU='104001')) AND PRODUCT_CODEU='03070200000000014';
UPDATE WM_MACHINE_CALL_DETAILU SET QUANTITYU=(QUANTITYU - (1000.0)) WHERE MACHINE_CALL_IDU IN (SELECT IDU FROM WM_MACHINE_CALLU WHERE PRODUCTION_PLAN_NOU='P202005100043' AND MACHINE_CODEU IN (SELECT MACHINE_CODEU FROM WM_MACHINE_PALLETU WHERE WORK_POSITION_NOU='104001')) AND PRODUCT_CODEU='03080202000000982';


/*

----下面应该是处理机组退料错误的sql
DELETE FROM WM_MACHINE_RETURN_DETAILU WHERE RETURN_BILL_NOU IN (
  SELECT RETURN_BILL_NOU FROM WM_MACHINE_RETURNU WHERE CURRENT_PLANU='P202005090019' AND MACHINE_CODEU = (
    SELECT MACHINE_CODEU FROM WM_MACHINE_PALLETU WHERE WORK_POSITION_NOU='204002' AND ROWNUM=1
  )
) AND PRODUCT_NAMEU='硬盒简化循环烟箱（芒果）' AND QUANTITYU=90 AND ROWNUM=1;


SELECT * FROM WM_MACHINE_HANDOVER_DETAILU WHERE TRANSFER_BILL_NOU='T202005060029' AND SOURCE_LOCATION_CODEU='108002' AND PRODUCT_NAMEU='120mm*21μm BOPP高收缩膜';

SELECT * FROM WM_MACHINE_HANDOVERU WHERE TRANSFER_BILL_NOU IN (
SELECT TRANSFER_BILL_NOU FROM WM_MACHINE_HANDOVER_DETAILU WHERE TRANSFER_BILL_NOU='T202005060029' AND SOURCE_LOCATION_CODEU='108002' AND PRODUCT_NAMEU='120mm*21μm BOPP高收缩膜'
);
SELECT * FROM WM_MACHINE_HANDOVER_DETAILU WHERE SOURCE_LOCATION_CODEU='103002' AND PRODUCT_NAMEU='114mm*55g银色复合内衬纸' AND IDU IN (
  SELECT TRANSFER_BILL_NOU FROM WM_MACHINE_HANDOVERU WHERE CURRENT_PLANU='P202005070023');

SELECT * FROM WM_MACHINE_CALLU WHERE IDU IN (
  SELECT MACHINE_CALL_IDU FROM WM_MACHINE_CALL_DETAILU WHERE MACHINE_CALL_IDU IN (SELECT IDU FROM WM_MACHINE_CALLU WHERE MACHINE_CODEU='B208' AND PALLET_POSITIONU='2') AND PRODUCT_NAMEU='120mm*21μm BOPP高收缩膜'
)  ORDER BY CREATE_TIMEU;
SELECT * FROM WM_MACHINE_CALL_DETAILU WHERE MACHINE_CALL_IDU IN (SELECT IDU FROM WM_MACHINE_CALLU WHERE MACHINE_CODEU='B208' AND PALLET_POSITIONU='2') AND PRODUCT_NAMEU='120mm*21μm BOPP高收缩膜' ORDER BY CREATE_TIMEU;
SELECT * FROM WM_MACHINE_CALL_DETAILU WHERE MACHINE_CALL_IDU IN (SELECT IDU FROM WM_MACHINE_CALLU WHERE PRODUCTION_PLAN_NOU='P202005070023');